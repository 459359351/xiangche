(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cb7c0ec"],{"1d85":function(e,t,i){},d652:function(e,t,i){"use strict";var n=i("1d85"),r=i.n(n);r.a},d78e:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{padding:"30px"}},[i("div",{staticClass:"app-container"},[i("el-button",{attrs:{type:"primary"},on:{click:e.handleAddRole}},[e._v("新增权限")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.roleList,stripe:""}},[i("el-table-column",{attrs:{align:"left",label:"用户名"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(i.user_name))]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"模块名称"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(i.display_name))]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"sign_id"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(i.sign_id))]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"total"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(i.total))]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return["000000"===n.sign_id?i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.handleCheck(n)}}},[e._v("审批")]):e._e(),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDelete(n,r)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible,title:"新增权限"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"dataForm",attrs:{model:e.role,"label-width":"80px","label-position":"left"}},[i("el-form-item",{attrs:{label:"用户名"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"选择用户"},model:{value:e.role.user_id,callback:function(t){e.$set(e.role,"user_id",t)},expression:"role.user_id"}},e._l(e.userMap,(function(e){return i("el-option",{key:e.id,attrs:{label:e.username,value:e.id}})})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"模块名"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"选择权限"},model:{value:e.role.module_id,callback:function(t){e.$set(e.role,"module_id",t)},expression:"role.module_id"}},e._l(e.moduleMap,(function(e){return i("el-option",{key:e.id,attrs:{label:e.display_name,value:e.id}})})),1)],1)],1),e._v(" "),i("div",{staticStyle:{"text-align":"right"}},[i("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmRole}},[e._v("确定")])],1)],1)],1)])},r=[],a=i("db72"),l=(i("6762"),i("2fdb"),i("c5f6"),i("75fc")),s=i("2d63"),o=(i("ac6a"),i("96cf"),i("3b8d")),c=i("df7c"),u=i.n(c),d=i("cc5e"),h=(i("4328"),{user_id:"",module_id:"",user_name:"",role:"",status:"",routes:[],display_name:""}),f=[{id:1,display_name:"网页前台"},{id:2,display_name:"网页后台"},{id:3,display_name:"AI"},{id:4,display_name:"APP"},{id:5,display_name:"社区"}],p={data:function(){return{visible:!1,role:Object.assign({},h),routes:[],roleList:[],moduleMap:[],listLoading:!0,moduleDisplayName:{},userMap:[],userDict:{},groupMap:f,dialogVisible:!1,checkStrictly:!1,defaultProps:{children:"children",label:"title"}}},computed:{routesData:function(){return this.routes}},created:function(){this.getAllRoles()},methods:{getAllRoles:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,i,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["e"])();case 2:t=e.sent,this.roleList=t.permission_data,this.moduleMap=t.module_data,this.userMap=t.user_data,i={},this.moduleMap.forEach((function(e,t){i[e.id]=e.display_name,n.moduleDisplayName[e.id]=e.display_name})),this.roleList.forEach((function(e,t){e["display_name"]=i[e.module_id]})),this.userMap.forEach((function(e){n.userDict[e.id]=e})),setTimeout((function(){n.listLoading=!1}),1e3);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),generateRoutes:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=[],r=Object(s["a"])(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(!a.hidden){var l=this.onlyOneShowingChild(a.children,a);a.children&&l&&!a.alwaysShow&&(a=l);var o={path:u.a.resolve(i,a.path),title:a.meta&&a.meta.title};a.children&&(o.children=this.generateRoutes(a.children,o.path)),n.push(o)}}}catch(c){r.e(c)}finally{r.f()}return n},generateArr:function(e){var t=this,i=[];return e.forEach((function(e){if(i.push(e),e.children){var n=t.generateArr(e.children);n.length>0&&(i=[].concat(Object(l["a"])(i),Object(l["a"])(n)))}})),i},handleAddRole:function(){this.role=Object.assign({},h),this.$refs.tree&&this.$refs.tree.setCheckedNodes([]),this.dialogType="new",this.dialogVisible=!0},handleCheck:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.role=t,e.next=3,Object(d["c"])({module_id:this.role.module_id,user_id:this.role.user_id});case 3:this.$message({type:"success",dangerouslyUseHTMLString:!0,message:"\n            <div>用户id：".concat(this.role.user_id," 权限审批成功</div>\n            ")}),this.getAllRoles();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleEdit:function(e){var t=this;this.dialogType="edit",this.dialogVisible=!0,this.checkStrictly=!0,this.role=e.row,this.$nextTick((function(){t.checkStrictly=!1}))},handleDelete:function(e,t){var i=this;this.$confirm("确定删除此用户?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:Object(d["d"])(e).then((function(e){200===Number(e.code)?(i.roleList.splice(t,1),i.$notify({title:"Success",message:"delete Permission Successfully",type:"success",duration:2e3})):i.$notify({title:"Failed",message:e.msg,type:"error",duration:2e3})}));case 1:case"end":return n.stop()}}),n)})))).catch((function(e){i.$message({type:"info",message:"已取消删除"})}))},generateTree:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=arguments.length>2?arguments[2]:void 0,r=[],a=Object(s["a"])(e);try{for(a.s();!(t=a.n()).done;){var l=t.value,o=u.a.resolve(i,l.path);l.children&&(l.children=this.generateTree(l.children,o,n)),(n.includes(o)||l.children&&l.children.length>=1)&&r.push(l)}}catch(c){a.e(c)}finally{a.f()}return r},confirmRole:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs["dataForm"].validate((function(e){if(e){var i=Object.assign({},t.role);i.user_name=t.userDict[i.user_id].username,i.group_id=t.userDict[i.user_id].group_id,i.display_name=t.moduleDisplayName[i.module_id],Object(d["a"])(i).then((function(e){200===Number(e.code)?(t.dialogVisible=!1,t.$notify({title:"Success",message:"Add Permission Successfully",type:"success",duration:2e3}),t.getAllRoles()):t.$notify({title:"Failed",message:e.msg,type:"error",duration:2e3})}))}}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,i=null,n=e.filter((function(e){return!e.hidden}));return 1===n.length?(i=n[0],i.path=u.a.resolve(t.path,i.path),i):0===n.length&&(i=Object(a["a"])({},t,{path:"",noShowingChildren:!0}),i)}}},m=p,g=(i("d652"),i("2877")),v=Object(g["a"])(m,n,r,!1,null,"70547212",null);t["default"]=v.exports}}]);